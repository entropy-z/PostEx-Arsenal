#ifndef DOTNET_H
#define DOTNET_H

#include <clr.hpp>

#define PIPE_BUFFER_LENGTH 0x10000

namespace mscorlib {
    #include <mscoree.hpp>
}

typedef mscorlib::_PropertyInfo IPropertyInfo;
typedef mscorlib::_AppDomain    IAppDomain;
typedef mscorlib::_Assembly     IAssembly;
typedef mscorlib::_Type         IType;
typedef mscorlib::_MethodInfo   IMethodInfo;
typedef mscorlib::BindingFlags  IBindingFlags;

struct {
    GUID CLRMetaHost;
    GUID CorRuntimeHost;
} xCLSID = {
    .CLRMetaHost    = { 0x9280188d, 0xe8e,  0x4867, { 0xb3, 0xc,  0x7f, 0xa8, 0x38, 0x84, 0xe8, 0xde } },
    .CorRuntimeHost = { 0xcb2f6723, 0xab3a, 0x11d2, { 0x9c, 0x40, 0x00, 0xc0, 0x4f, 0xa3, 0x0a, 0x3e } }
};

struct {
    GUID MscorlibAsm;
    GUID IHostControl;
    GUID AppDomain;
    GUID ICLRMetaHost;
    GUID ICLRRuntimeInfo;
    GUID ICorRuntimeHost;
    GUID IDispatch;
} xIID = {
    .MscorlibAsm      = { 0x17156360, 0x2F1A, 0x384A, { 0xBC, 0x52, 0xFD, 0xE9, 0x3C, 0x21, 0x5C, 0x5B } },
    .IHostControl     = { 0x02CA073C, 0x7079, 0x4860, { 0x88, 0x0A, 0xC2, 0xF7, 0xA4, 0x49, 0xC9, 0x91 } },
    .AppDomain        = { 0x05F696DC, 0x2B29, 0x3663, { 0xAD, 0x8B, 0xC4, 0x38, 0x9C, 0xF2, 0xA7, 0x13 } },
    .ICLRMetaHost     = { 0xD332DB9E, 0xB9B3, 0x4125, { 0x82, 0x07, 0xA1, 0x48, 0x84, 0xF5, 0x32, 0x16 } },
    .ICLRRuntimeInfo  = { 0xBD39D1D2, 0xBA2F, 0x486a, { 0x89, 0xB0, 0xB4, 0xB0, 0xCB, 0x46, 0x68, 0x91 } },
    .ICorRuntimeHost  = { 0xcb2f6722, 0xab3a, 0x11d2, { 0x9c, 0x40, 0x00, 0xc0, 0x4f, 0xa3, 0x0a, 0x3e } },
    .IDispatch        = { 0x00020400, 0x0000, 0x0000, { 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46 } }
};

#endif // DOTNET_H